{
  "version": "2.0.0",
  "windows": {
    "options": {
      "shell": { "executable": "cmd.exe", "args": ["/d", "/c"] }
    }
  },
  "tasks": [
    {
      "type": "cmake",
      "label": "CMake: clean rebuild",
      "command": "cleanRebuild",
      "targets": ["all"],
      "preset": "Debug",
      "group": "build",
      "problemMatcher": [],
      "detail": "CMake template clean rebuild task"
    },
    {
      "type": "shell",
      "label": "CubeProg: Flash project (SWD)",
      "command": "C:\\Program Files\\STMicroelectronics\\STM32Cube\\STM32CubeProgrammer\\bin\\STM32_Programmer_CLI.exe",
      "args": [
        "-c","port=SWD","mode=UR","reset=HWrst",
        "-w","${command:cmake.launchTargetPath}",
        "-v","-rst"
      ],
      "options": { "cwd": "${workspaceFolder}" },
      "problemMatcher": []
    },
    {
      "label": "Build + Flash",
      "dependsOrder": "sequence",
      "dependsOn": ["CMake: clean rebuild", "CubeProg: Flash project (SWD)"]
    },
    {
      "type": "shell",
      "label": "CubeProg: List interfaces",
      "command": "C:\\Program Files\\STMicroelectronics\\STM32Cube\\STM32CubeProgrammer\\bin\\STM32_Programmer_CLI.exe",
      "args": ["-l"],
      "options": { "cwd": "${workspaceFolder}" },
      "problemMatcher": []
    }
  ]
}
